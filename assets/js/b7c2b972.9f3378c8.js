"use strict";(globalThis.webpackChunkunitary=globalThis.webpackChunkunitary||[]).push([[6293],{6346:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"write-tests","title":"Write Tests","description":"Groups define the subject for the test, test begins with an input and a set of expectations and each validation describes one of its responsibilities with clear intent.","source":"@site/docs/write-tests.mdx","sourceDirName":".","slug":"/write-tests","permalink":"/Unitary/docs/write-tests","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Get Started","permalink":"/Unitary/docs/get-started"},"next":{"title":"Run tests","permalink":"/Unitary/docs/run-tests"}}');var i=n(4848),a=n(8453);const r={sidebar_position:2},o="Write Tests",l={},c=[{value:"Writing Tests in Unitary",id:"writing-tests-in-unitary",level:2},{value:"Execute",id:"execute",level:4},{value:"Response",id:"response",level:4},{value:"Descriptions",id:"descriptions",level:2},{value:"Response",id:"response-1",level:4},{value:"Hard stops",id:"hard-stops",level:2},{value:"Response",id:"response-2",level:4},{value:"Debug output",id:"debug-output",level:2},{value:"Response",id:"response-3",level:4},{value:"Advanced usage",id:"advanced-usage",level:2},{value:"Callback-based validation",id:"callback-based-validation",level:3},{value:"Soft stop",id:"soft-stop",level:3},{value:"Quick custom validations",id:"quick-custom-validations",level:2}];function d(e){const s={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"write-tests",children:"Write Tests"})}),"\n",(0,i.jsx)(s.p,{children:"Groups define the subject for the test, test begins with an input and a set of expectations and each validation describes one of its responsibilities with clear intent."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"writing-tests-in-unitary",children:"Writing Tests in Unitary"}),"\n",(0,i.jsxs)(s.p,{children:["A unitary test file can include one or more ",(0,i.jsx)(s.code,{children:"group()"}),", each serving as a container for tests that validate a specific subject. Each group runs within its own isolated scope, allowing you to safely add business logic while keeping side effects and dependencies contained. You can then add multiple tests within each group."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-php",children:'use MaplePHP\\Unitary\\{Expect,TestCase};\n\ngroup("HTTP Request", function(TestCase $case) {\n\n    $request = new Request("GET", "https://example.com/?id=1&slug=hello");\n\n    $case->expect($request->getMethod())\n        ->isRequestMethod()\n        ->validate();\n\n    $case->expect($request->getUri()->getQuery())\n        ->hasQueryParam("id", 1)\n        ->hasQueryParam("slug", "hello")\n        ->validate();\n});\n'})}),"\n",(0,i.jsx)(s.h4,{id:"execute",children:"Execute"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"php vendor/bin/unitary\n"})}),"\n",(0,i.jsx)(s.h4,{id:"response",children:"Response"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://wazabii.se/github-assets/unitary/unitary-cli-state-pass.png",alt:"Unitary CLI response"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"descriptions",children:"Descriptions"}),"\n",(0,i.jsx)(s.p,{children:"Descriptions are optional and useful when the purpose of a validation isn\u2019t immediately obvious."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-php",children:'use MaplePHP\\Unitary\\{Expect,TestCase};\n\ngroup("Validating API Response", function(TestCase $case) {\n\n    $json = \'{"response":{"status":404,"message":"ok"}}\';\n\n    $case->expect($json)\n        ->isJson()\n        ->describe("Response must be valid JSON")\n        ->hasJsonValueAt("response.status", 200)\n        ->describe("Response status must be 200")\n        ->validate("API response status");\n});\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"describe()"}),": Add optional description to explain the validation and chain them when more clarity is needed."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"validate()"}),": You can define a optional ",(0,i.jsx)(s.strong,{children:"heading"})," for the validation."]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"response-1",children:"Response"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://wazabii.se/github-assets/unitary/unitary-cli-description.png",alt:"Unitary CLI response"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"hard-stops",children:"Hard stops"}),"\n",(0,i.jsx)(s.p,{children:"A hard stop aborts the current group immediately. No further validations or logic inside that group will run but will continue with the next group in the same test file if it exists."}),"\n",(0,i.jsxs)(s.p,{children:["You may chain ",(0,i.jsx)(s.code,{children:"assert()"})," as the final step, replaces ",(0,i.jsx)(s.code,{children:"validate()"})," to trigger a ",(0,i.jsx)(s.strong,{children:"hard stop"})," in the group. Validations below it will not run, which is helpful when later checks depend on earlier conditions or when you want to avoid cascading errors."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-php",children:'use MaplePHP\\Unitary\\{Expect,TestCase};\n\ngroup("Validating API Response", function(TestCase $case) {\n\n    $json = \'{"response":{"status":404,"message":"ok"}}\';\n\n    $case->expect($json)\n        ->isJson()\n        ->hasJsonValueAt("response.status", 200)\n        ->assert("API response status");\n});\n'})}),"\n",(0,i.jsx)(s.h4,{id:"response-2",children:"Response"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://wazabii.se/github-assets/unitary/unitary-cli-hard-stop.png",alt:"Unitary CLI response"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"debug-output",children:"Debug output"}),"\n",(0,i.jsxs)(s.p,{children:["Unitary is built to make testing feel natural. That means you can debug with normal ",(0,i.jsx)(s.code,{children:"print_r()"}),", ",(0,i.jsx)(s.code,{children:"var_dump()"}),", or ",(0,i.jsx)(s.code,{children:"echo"})," and Unitary will capture and display the output neatly in the CLI."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-php",children:"use MaplePHP\\Unitary\\{Expect,TestCase};\n\ngroup(\"Debug example\", function(TestCase $case) {\n    print_r(['milk', 'cheese', 'bread']);\n});\n"})}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Note:"}),"\nPrints made ",(0,i.jsx)(s.em,{children:"outside"})," of a ",(0,i.jsx)(s.code,{children:"group()"})," may not appear in the CLI stream.\nIf you need to see such output, you need to call ",(0,i.jsx)(s.code,{children:"die()"})," or ",(0,i.jsx)(s.code,{children:"exit()"})," after printing."]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"response-3",children:"Response"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://wazabii.se/github-assets/unitary/unitary-cli-debug-output.png",alt:"Unitary CLI response"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"advanced-usage",children:"Advanced usage"}),"\n",(0,i.jsx)(s.h3,{id:"callback-based-validation",children:"Callback-based validation"}),"\n",(0,i.jsx)(s.p,{children:"Use the callback-based validation when a validation needs staged or conditional logic."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-php",children:'use MaplePHP\\Unitary\\{TestCase,Expect};\n\ngroup("Advanced example", function(TestCase $case) {\n\n    $json = \'{"response":{"status":200,"message":"ok"}}\';\n\n    $case->validate($json, function(Expect $expect) {\n\n        $expect->isJson()\n               ->hasJsonValueAt("response.status", 200);\n    });\n\n});\n'})}),"\n",(0,i.jsx)(s.h3,{id:"soft-stop",children:"Soft stop"}),"\n",(0,i.jsxs)(s.p,{children:["The callback-based validation also supports ",(0,i.jsx)(s.strong,{children:"soft stops"}),", which end only the current validation block. This is ideal for dependent checks or logic that should run only after earlier conditions succeed."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-php",children:"use MaplePHP\\Unitary\\{TestCase,Expect};\n\ngroup(\"2. Soft stop examples\", function(TestCase $case) {\n  $case->validate($userData, function(Expect $expect) {\n\n      $expect->isArray()->assert(\"User data must be an array\");\n\n      $data = $expect->val();\n\n      if (($data['role'] ?? null) === 'admin') {\n          $expect->hasArrayKey('permissions')\n                 ->assert(\"Admin missing permissions\");\n      }\n\n      $expect->hasArrayKey('email');\n  });\n\n});\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.em,{children:"Use this when the validation itself needs internal structure."})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"quick-custom-validations",children:"Quick custom validations"}),"\n",(0,i.jsxs)(s.p,{children:["When a test needs logic that isn\u2019t covered by Unitary\u2019s built-in expectations, you can define custom checks directly.\nA native ",(0,i.jsx)(s.code,{children:"assert()"})," inside a ",(0,i.jsx)(s.strong,{children:"group"})," creates a hard stop, while an ",(0,i.jsx)(s.code,{children:"assert()"})," inside a ",(0,i.jsx)(s.strong,{children:"validation callback"})," becomes a soft stop and the validation is still counted."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-php",children:'use MaplePHP\\Unitary\\{Expect,TestCase};\n\ngroup("Preconditions", function(TestCase $case) {\n\n    // Hard stop: group ends immediately if this fails\n    assert(1 === 1, "Setup is invalid 1");\n\n    // Soft stop inside a validation: validation is counted\n    $case->validate($userData, function(Expect $expect) {\n        assert(1 === 1, "Setup is invalid 2");\n    });\n\n    // Custom validation returning a boolean\n    $case->validate(1, function(Expect $expect) {\n        return $expect->val() === 1;\n    });\n});\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsxs)(s.em,{children:["You now know how to create and structure Unitary tests from simple validations to advanced grouped assertions.\nFor a complete list of validation methods that make your testing even easier, see the ",(0,i.jsx)(s.a,{href:"/Unitary/validation-api",children:"Validation API"}),"."]})})]})}function p(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>o});var t=n(6540);const i={},a=t.createContext(i);function r(e){const s=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);