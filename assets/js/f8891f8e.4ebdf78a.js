"use strict";(globalThis.webpackChunkunitary=globalThis.webpackChunkunitary||[]).push([[8968],{8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(6540);const s={},a=t.createContext(s);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(a.Provider,{value:n},e.children)}},8832:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"mocker/mocking-final-private-methods","title":"Mocking Final & Private Methods","description":"Mocking Final & Private Methods","source":"@site/docs/mocker/4-mocking-final-private-methods.md","sourceDirName":"mocker","slug":"/mocker/mocking-final-private-methods","permalink":"/Unitary/docs/mocker/mocking-final-private-methods","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Mocking Final & Private Methods"},"sidebar":"tutorialSidebar","previous":{"title":"Method Expectations & Behaviors","permalink":"/Unitary/docs/mocker/method-expectations"},"next":{"title":"Configuration","permalink":"/Unitary/docs/configuration"}}');var s=i(4848),a=i(8453);const o={title:"Mocking Final & Private Methods"},r=void 0,l={},c=[{value:"Mocking Final &amp; Private Methods",id:"mocking-final--private-methods",level:2},{value:"Focus on Testable Design",id:"focus-on-testable-design",level:2},{value:"Use Interfaces Instead of Final Classes or Methods",id:"use-interfaces-instead-of-final-classes-or-methods",level:2},{value:"Why Interfaces Help",id:"why-interfaces-help",level:3},{value:"Example",id:"example",level:3},{value:"Even if the real mailer is final:",id:"even-if-the-real-mailer-is-final",level:4},{value:"Your application can remain flexible:",id:"your-application-can-remain-flexible",level:4},{value:"Then in you test, just mock the interface:",id:"then-in-you-test-just-mock-the-interface",level:4},{value:"Why You Shouldn&#39;t Mock Private Methods",id:"why-you-shouldnt-mock-private-methods",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"mocking-final--private-methods",children:"Mocking Final & Private Methods"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Unitary doesn\u2019t support mocking final or private methods \u2014 by design."})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This isn\u2019t a technical limitation, it\u2019s an intentional choice. Mocking in Unitary is meant to reflect how your system is structured, not bypass it."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"focus-on-testable-design",children:"Focus on Testable Design"}),"\n",(0,s.jsxs)(n.p,{children:["Unitary encourages testing ",(0,s.jsx)(n.em,{children:"behavior"}),", not internal implementation details. That means relying on public methods and substitutable dependencies."]}),"\n",(0,s.jsx)(n.p,{children:"If you find yourself needing to mock a private or final method, it's often a sign the design could be improved."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"use-interfaces-instead-of-final-classes-or-methods",children:"Use Interfaces Instead of Final Classes or Methods"}),"\n",(0,s.jsx)(n.p,{children:"Final classes and methods can\u2019t be mocked in PHP, not in Unitary or any other framework. But if you rely on an interface instead of the concrete class, mocking becomes straightforward."}),"\n",(0,s.jsx)(n.h3,{id:"why-interfaces-help",children:"Why Interfaces Help"}),"\n",(0,s.jsx)(n.p,{children:"Interfaces describe behavior without tying you to an implementation. If your class depends on an interface, you can easily replace it in tests, no matter how the real class is built."}),"\n",(0,s.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"interface MailerInterface {\n    public function send(string $to, string $subject, string $body): bool;\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"even-if-the-real-mailer-is-final",children:"Even if the real mailer is final:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"final class Mailer implements MailerInterface {\n    public function send(string $to, string $subject, string $body): bool\n    {\n        // Implementation details\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"your-application-can-remain-flexible",children:"Your application can remain flexible:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"class NotificationService {\n    public function __construct(private MailerInterface $mailer) {}\n\n    public function sendWelcome(string $email): bool {\n        return $this->mailer->send($email, 'Welcome', 'Thanks for signing up.');\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"then-in-you-test-just-mock-the-interface",children:"Then in you test, just mock the interface:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"group('Sends welcome email', function ($test) {\n    $mailer = $test->mock(MailerInterface::class, function ($mock) {\n        $mock->method('send')->willReturn(true)->called(1);\n    });\n\n    $service = new NotificationService($mailer);\n    $result = $service->sendWelcome('john@example.com');\n\n    $test->validate($result, fn($v) => $v->isTrue());\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"You\u2019re testing behavior, not implementation. That\u2019s the goal."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"why-you-shouldnt-mock-private-methods",children:"Why You Shouldn't Mock Private Methods"}),"\n",(0,s.jsx)(n.p,{children:"Private methods are internal details. They aren't meant to be called directly, and they aren\u2019t meant to be mocked."}),"\n",(0,s.jsx)(n.p,{children:"If a private method contains logic important enough to test, consider:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Moving it to its own class"}),"\n",(0,s.jsx)(n.li,{children:"Making it public or protected in a dedicated helper"}),"\n",(0,s.jsx)(n.li,{children:"Rethinking its role in the design"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The aim is to keep logic visible and testable."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"If mocking feels difficult, the code may need a small design adjustment."}),"\nUnitary supports clear, testable architecture, use interfaces, inject dependencies, and focus on behavior."]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);