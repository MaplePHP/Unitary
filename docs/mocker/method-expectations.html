<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-mocker/method-expectations" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Method Expectations &amp; Behaviors | PHP Unitary</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://maplephp.github.io/Unitary/img/validate-social-card.png"><meta data-rh="true" name="twitter:image" content="https://maplephp.github.io/Unitary/img/validate-social-card.png"><meta data-rh="true" property="og:url" content="https://maplephp.github.io/Unitary/docs/mocker/method-expectations"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="theme-color" content="#ffffff"><meta data-rh="true" name="msapplication-TileColor" content="#ffffff"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Method Expectations &amp; Behaviors | PHP Unitary"><meta data-rh="true" name="description" content="Even though Unitary allows you to mock classes in a single line, there are times when you may want more control."><meta data-rh="true" property="og:description" content="Even though Unitary allows you to mock classes in a single line, there are times when you may want more control."><link data-rh="true" rel="icon" href="/Unitary/favicon.ico"><link data-rh="true" rel="canonical" href="https://maplephp.github.io/Unitary/docs/mocker/method-expectations"><link data-rh="true" rel="alternate" href="https://maplephp.github.io/Unitary/docs/mocker/method-expectations" hreflang="en"><link data-rh="true" rel="alternate" href="https://maplephp.github.io/Unitary/docs/mocker/method-expectations" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Unitary/blog/rss.xml" title="PHP Unitary RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Unitary/blog/atom.xml" title="PHP Unitary Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M3092KZDQF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-M3092KZDQF",{anonymize_ip:!0})</script>



<link rel="apple-touch-icon" sizes="180x180" href="/Unitary/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="96x96" href="/Unitary/favicon-96x96.png">
<link rel="manifest" href="/Unitary/site.webmanifest"><link rel="stylesheet" href="/Unitary/assets/css/styles.82669139.css">
<script src="/Unitary/assets/js/runtime~main.16f69d68.js" defer="defer"></script>
<script src="/Unitary/assets/js/main.4b086ee6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/Unitary/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Unitary/"><div class="navbar__logo"><img src="/Unitary/img/logo.svg" alt="Unitary" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Unitary/img/logo.svg" alt="Unitary" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">PHP Unitary</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Unitary/docs/get-started">The Documentation</a><a class="navbar__item navbar__link" href="/Unitary/validation-api">Validation API</a><a class="navbar__item navbar__link" href="/Unitary/why-unitary">Why Unitary?</a><a class="navbar__item navbar__link" href="/Unitary/faq">FAQ</a></div><div class="navbar__items navbar__items--right"><button class="search-icon-btn" title="Search"><span>Ctrl+G</span><svg id="i-search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="14" cy="14" r="12"></circle><path d="M23 23 L30 30"></path></svg></button><a href="https://github.com/MaplePHP/Unitary" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/get-started">Get Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/write-tests">Write Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/run-tests">Run tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/partial-overrides">Partial Overrides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/Unitary/docs/mocker/introduction-to-mocker">Mocking &amp; Stubbing</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Unitary/docs/mocker/introduction-to-mocker">Introduction to Mocker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Unitary/docs/mocker/creating-mocks">Creating mocks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Unitary/docs/mocker/method-expectations">Method Expectations &amp; Behaviors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Unitary/docs/mocker/mocking-final-private-methods">Mocking Final &amp; Private Methods</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/ide-integration">IDE Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/code-coverage">Code Coverage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Unitary/docs/audit">Audits</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Unitary/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Mocking &amp; Stubbing</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Method Expectations &amp; Behaviors</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Method Expectations &amp; Behaviors</h1></header>
<p>Even though Unitary allows you to mock classes in a single line, there are times when you may want more control.</p>
<p>When mocking methods in Unitary, you can optionally define how they should behave and how they are expected to be used.  This guide explains how to configure method behaviors and expectations using the <code>mock()</code> and <code>method()</code> APIs when needed.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="return-values">Return Values<a href="#return-values" class="hash-link" aria-label="Direct link to Return Values" title="Direct link to Return Values">​</a></h2>
<p>To specify a static return value:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$someClass</span><span class="token plain"> </span><span class="token operator" style="color:#D4D4D4">=</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$case</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">mock</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name static-context" style="color:#0ea5e9">SomeClass</span><span class="token operator" style="color:#D4D4D4">::</span><span class="token keyword" style="color:#569CD6">class</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name type-declaration" style="color:#0ea5e9">MethodRegistry</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;getCount&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">willReturn</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token number" style="color:#B5CEA8">42</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Whenever <code>getCount()</code> is called on the mock, it returns <code>42</code>.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="return-values-by-call-order">Return Values by Call Order<a href="#return-values-by-call-order" class="hash-link" aria-label="Direct link to Return Values by Call Order" title="Direct link to Return Values by Call Order">​</a></h2>
<p>You can define a sequence of return values for successive calls:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$someClass</span><span class="token plain"> </span><span class="token operator" style="color:#D4D4D4">=</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$case</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">mock</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name static-context" style="color:#0ea5e9">SomeClass</span><span class="token operator" style="color:#D4D4D4">::</span><span class="token keyword" style="color:#569CD6">class</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name type-declaration" style="color:#0ea5e9">MethodRegistry</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;getId&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">willReturn</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token number" style="color:#B5CEA8">1001</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">1002</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">1003</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>On the first call, it returns <code>1001</code>; on the second, <code>1002</code>; on the third, <code>1003</code>, and so on.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="keeping-original-behavior">Keeping original behavior<a href="#keeping-original-behavior" class="hash-link" aria-label="Direct link to Keeping original behavior" title="Direct link to Keeping original behavior">​</a></h2>
<p>Use <code>keepOriginal()</code> when a mocked method should run <strong>unchanged</strong>.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;getFromEmail&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">keepOriginal</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The method executes exactly as it does on the real class. No interception, no modification, no simulation.</p>
<p>This is useful when a mock only needs control over specific methods and the remaining behavior should stay real. It allows a mocked instance to participate in an integration-oriented test without replacing logic that is not relevant to the validation.</p>
<p><code>keepOriginal()</code> makes the intent explicit: the method exists on the mock, but its behavior is untouched.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wrapping-behavior">Wrapping behavior<a href="#wrapping-behavior" class="hash-link" aria-label="Direct link to Wrapping behavior" title="Direct link to Wrapping behavior">​</a></h2>
<p>Use <code>wrap()</code> when a method should run <strong>custom test logic while still operating on the real class instance</strong>.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;sendEmail&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">wrap</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token keyword type-hint" style="color:#569CD6">string</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$email</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token keyword" style="color:#569CD6">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token operator" style="color:#D4D4D4">!</span><span class="token variable" style="color:#9CDCFE">$this</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">isValidEmail</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token variable" style="color:#9CDCFE">$email</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">        </span><span class="token keyword" style="color:#569CD6">return</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;FAILED&#x27;</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token keyword" style="color:#569CD6">return</span><span class="token plain"> </span><span class="token string double-quoted-string" style="color:#cbd5e1">&quot;email:</span><span class="token string double-quoted-string interpolation punctuation" style="color:#D4D4D4">{</span><span class="token string double-quoted-string interpolation variable" style="color:#9CDCFE">$email</span><span class="token string double-quoted-string interpolation punctuation" style="color:#D4D4D4">}</span><span class="token string double-quoted-string" style="color:#cbd5e1">&quot;</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The wrapped method executes with <code>$this</code> bound to the original class instance. This allows the wrapper to call real helper methods, rely on internal state, and reuse existing validation logic.</p>
<p>Wrapping neither replaces the method nor leaves it untouched. It modifies execution at a specific point while keeping the surrounding behavior real.</p>
<p>Use wrapping when you need control without losing access to the original implementation.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="throwing-exceptions">Throwing Exceptions<a href="#throwing-exceptions" class="hash-link" aria-label="Direct link to Throwing Exceptions" title="Direct link to Throwing Exceptions">​</a></h2>
<p>To simulate errors, you can configure a method to throw:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$someClass</span><span class="token plain"> </span><span class="token operator" style="color:#D4D4D4">=</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$case</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">mock</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name static-context" style="color:#0ea5e9">SomeClass</span><span class="token operator" style="color:#D4D4D4">::</span><span class="token keyword" style="color:#569CD6">class</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name type-declaration" style="color:#0ea5e9">MethodRegistry</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;connect&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">willThrow</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token keyword" style="color:#569CD6">new</span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified punctuation" style="color:#D4D4D4">\</span><span class="token class-name class-name-fully-qualified" style="color:#0ea5e9">RuntimeException</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;Connection failed&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Whenever <code>connect()</code> is called, a <code>RuntimeException</code> is thrown.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mixing-throw-and-return">Mixing <code>throw</code> and <code>return</code><a href="#mixing-throw-and-return" class="hash-link" aria-label="Direct link to mixing-throw-and-return" title="Direct link to mixing-throw-and-return">​</a></h2>
<p>You can combine <code>willThrowOnce()</code> and <code>willReturn()</code> to define behavior over time:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$someClass</span><span class="token plain"> </span><span class="token operator" style="color:#D4D4D4">=</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$case</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">mock</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name static-context" style="color:#0ea5e9">SomeClass</span><span class="token operator" style="color:#D4D4D4">::</span><span class="token keyword" style="color:#569CD6">class</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name type-declaration" style="color:#0ea5e9">MethodRegistry</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;fetch&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">        </span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">willThrowOnce</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token keyword" style="color:#569CD6">new</span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified punctuation" style="color:#D4D4D4">\</span><span class="token class-name class-name-fully-qualified" style="color:#0ea5e9">Exception</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;Failed&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">        </span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">willReturn</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;Success&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The first call to <code>fetch()</code> throws an exception; the second returns <code>&#x27;Success&#x27;</code>.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="argument-expectations">Argument Expectations<a href="#argument-expectations" class="hash-link" aria-label="Direct link to Argument Expectations" title="Direct link to Argument Expectations">​</a></h2>
<p>You can ensure the method receives exact arguments when called:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$someClass</span><span class="token plain"> </span><span class="token operator" style="color:#D4D4D4">=</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$case</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">mock</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name static-context" style="color:#0ea5e9">SomeClass</span><span class="token operator" style="color:#D4D4D4">::</span><span class="token keyword" style="color:#569CD6">class</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name type-declaration" style="color:#0ea5e9">MethodRegistry</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;addFromEmail&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">        </span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">withArguments</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;john.doe@gmail.com&#x27;</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;John Doe&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This verifies that the method is called with the given values in the correct order.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-per-call">Arguments per Call<a href="#arguments-per-call" class="hash-link" aria-label="Direct link to Arguments per Call" title="Direct link to Arguments per Call">​</a></h2>
<p>If you expect different arguments on each call:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$someClass</span><span class="token plain"> </span><span class="token operator" style="color:#D4D4D4">=</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$case</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">mock</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name static-context" style="color:#0ea5e9">SomeClass</span><span class="token operator" style="color:#D4D4D4">::</span><span class="token keyword" style="color:#569CD6">class</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name type-declaration" style="color:#0ea5e9">MethodRegistry</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;addFromEmail&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">        </span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">withArgumentsForCalls</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">            </span><span class="token punctuation" style="color:#D4D4D4">[</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;john.doe@gmail.com&#x27;</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;John Doe&#x27;</span><span class="token punctuation" style="color:#D4D4D4">]</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">            </span><span class="token punctuation" style="color:#D4D4D4">[</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;jane.doe@gmail.com&#x27;</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;Jane Doe&#x27;</span><span class="token punctuation" style="color:#D4D4D4">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">        </span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The first call must match the first argument set, the second call the second set, and so on.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="call-count-expectations">Call Count Expectations<a href="#call-count-expectations" class="hash-link" aria-label="Direct link to Call Count Expectations" title="Direct link to Call Count Expectations">​</a></h2>
<p>You can also enforce how many times a method must be called:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8fafc;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#f8fafc;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8fafc"><span class="token variable" style="color:#9CDCFE">$someClass</span><span class="token plain"> </span><span class="token operator" style="color:#D4D4D4">=</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$case</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">mock</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name static-context" style="color:#0ea5e9">SomeClass</span><span class="token operator" style="color:#D4D4D4">::</span><span class="token keyword" style="color:#569CD6">class</span><span class="token punctuation" style="color:#D4D4D4">,</span><span class="token plain"> </span><span class="token keyword" style="color:#569CD6">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token class-name type-declaration" style="color:#0ea5e9">MethodRegistry</span><span class="token plain"> </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#D4D4D4">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain">    </span><span class="token variable" style="color:#9CDCFE">$method</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">method</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token string single-quoted-string" style="color:#cbd5e1">&#x27;save&#x27;</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token operator" style="color:#D4D4D4">-&gt;</span><span class="token function" style="color:#7dd3fc">called</span><span class="token punctuation" style="color:#D4D4D4">(</span><span class="token number" style="color:#B5CEA8">1</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8fafc"><span class="token plain"></span><span class="token punctuation" style="color:#D4D4D4">}</span><span class="token punctuation" style="color:#D4D4D4">)</span><span class="token punctuation" style="color:#D4D4D4">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This ensures <code>save()</code> is called exactly once. If not, the test fails.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="available-call-count-methods">Available call count methods:<a href="#available-call-count-methods" class="hash-link" aria-label="Direct link to Available call count methods:" title="Direct link to Available call count methods:">​</a></h3>
<table><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td><code>called(1)</code></td><td>Must be called exactly once</td></tr><tr><td><code>called(0)</code></td><td>Must never be called</td></tr><tr><td><code>atLeast(2)</code></td><td>Must be called two or more times</td></tr><tr><td><code>atMost(3)</code></td><td>Must not be called more than three times</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-notes">Additional Notes<a href="#additional-notes" class="hash-link" aria-label="Direct link to Additional Notes" title="Direct link to Additional Notes">​</a></h2>
<ul>
<li><code>willReturn(...)</code> sets fixed outputs.</li>
<li><code>wrap(...)</code> gives you dynamic behavior and full class context.</li>
<li><code>willThrow(...)</code> and <code>willThrowOnce(...)</code> simulate failure scenarios.</li>
<li><code>withArguments(...)</code> and <code>called(...)</code> help you assert correct usage.</li>
<li>You can combine all of them for powerful test behavior simulation.</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Unitary/docs/mocker/creating-mocks"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Creating mocks</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Unitary/docs/mocker/mocking-final-private-methods"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Mocking Final &amp; Private Methods</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#return-values" class="table-of-contents__link toc-highlight">Return Values</a></li><li><a href="#return-values-by-call-order" class="table-of-contents__link toc-highlight">Return Values by Call Order</a></li><li><a href="#keeping-original-behavior" class="table-of-contents__link toc-highlight">Keeping original behavior</a></li><li><a href="#wrapping-behavior" class="table-of-contents__link toc-highlight">Wrapping behavior</a></li><li><a href="#throwing-exceptions" class="table-of-contents__link toc-highlight">Throwing Exceptions</a></li><li><a href="#mixing-throw-and-return" class="table-of-contents__link toc-highlight">Mixing <code>throw</code> and <code>return</code></a></li><li><a href="#argument-expectations" class="table-of-contents__link toc-highlight">Argument Expectations</a></li><li><a href="#arguments-per-call" class="table-of-contents__link toc-highlight">Arguments per Call</a></li><li><a href="#call-count-expectations" class="table-of-contents__link toc-highlight">Call Count Expectations</a><ul><li><a href="#available-call-count-methods" class="table-of-contents__link toc-highlight">Available call count methods:</a></li></ul></li><li><a href="#additional-notes" class="table-of-contents__link toc-highlight">Additional Notes</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Unitary/docs/get-started">Get started</a></li><li class="footer__item"><a class="footer__link-item" href="/Unitary/docs/run-tests">Write Tests</a></li><li class="footer__item"><a class="footer__link-item" href="/Unitary/docs/run-tests">Run Tests</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MaplePHP/Unitary" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://se.linkedin.com/in/daniel-ronkainen-161b3386/en" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MaplePHP/unitary" target="_blank" rel="noopener noreferrer" class="footer__link-item">Unitary<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MaplePHP/maplephp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Emitron<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MaplePHP/http" target="_blank" rel="noopener noreferrer" class="footer__link-item">HTTP message<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MaplePHP/Prompts" target="_blank" rel="noopener noreferrer" class="footer__link-item">Prompts<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MaplePHP/Blunder" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blunder<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MaplePHP/validate" target="_blank" rel="noopener noreferrer" class="footer__link-item">Validate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MaplePHP/dto" target="_blank" rel="noopener noreferrer" class="footer__link-item">Darn Tidy object<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MaplePHP/container" target="_blank" rel="noopener noreferrer" class="footer__link-item">Container<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MaplePHP/cache" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cache<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Darn Tidy Object (Unitary), Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>