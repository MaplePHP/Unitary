#!/usr/bin/env php
<?php
/**
 * MaplePHP Unitary bin file
 */

use MaplePHP\Blunder\Handlers\CliHandler;
use MaplePHP\Unitary\Console\Application;


$autoload = __DIR__ . '/../../../../vendor/autoload.php';
$autoload = is_file($autoload) ? $autoload : __DIR__ . '/../vendor/autoload.php';
$autoload = realpath($autoload);

if (!$autoload || !is_file($autoload)) {
    if (!empty($GLOBALS['_composer_autoload_path'])) {
        $autoload = $GLOBALS['_composer_autoload_path'];
    } else {
        fwrite(STDERR, "Autoloader not found. Run `composer install`.\n");
        exit(1);
    }
}

require $autoload;

$app = (new Application())
        ->withErrorHandler(new CliHandler())
        ->boot([
            "argv" => $argv,
            "dir" => getcwd()
        ]);
